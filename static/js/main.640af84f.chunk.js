(this["webpackJsonpreact-rps"]=this["webpackJsonpreact-rps"]||[]).push([[0],{26:function(e,a,t){e.exports=t(41)},31:function(e,a,t){},41:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(23),s=t.n(c),o=(t(31),t(3)),l=t(8),i=t(2),m=t(6),u=t.n(m),p=t(10),d=t(12);t(33);d.initializeApp({apiKey:"AIzaSyCpU5AfFhgbrjaTR8sKyB_O6h9VYGCNmDk",authDomain:"rock-paper-scissors-b198e.firebaseapp.com",databaseURL:"https://rock-paper-scissors-b198e.firebaseio.com",projectId:"rock-paper-scissors-b198e",storageBucket:"rock-paper-scissors-b198e.appspot.com",messagingSenderId:"530589049037",appId:"1:530589049037:web:f677fbd6b66d8483654984"});var f=d.firestore(),b=function(e){return f.collection("games").doc(e)},h=function(e,a){var t={userId:a,weapon:null};(e instanceof d.firestore.DocumentReference?e:b(e)).collection("players").add(t).catch((function(e){return console.log("Error encountered: ".concat(e))}))},v=function(){var e=Object(p.a)(u.a.mark((function e(a,t,n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={weapon:n},e.abrupt("return",a.collection("players").where("userId","==",t).get().then((function(e){return e.docs[0].ref.update(r)})));case 2:case"end":return e.stop()}}),e)})));return function(a,t,n){return e.apply(this,arguments)}}(),E=function(){var e=Object(p.a)(u.a.mark((function e(a,t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a.collection("players").where("userId","==",t).get().then((function(e){return e.empty?h(a,t).then((function(){return null})):e.docs[0].data().weapon})));case 1:case"end":return e.stop()}}),e)})));return function(a,t){return e.apply(this,arguments)}}(),g=function(e){var a={tie:!1,userId:null,weapon:null};if(e.length<2||e.some((function(e){return null===e.weapon})))return a;var t=Object(i.a)(e,2),n=t[0],r=t[1];return"Rock"===n.weapon&&"Scissors"===r.weapon||"Paper"===n.weapon&&"Rock"===r.weapon||"Scissors"===n.weapon&&"Paper"===r.weapon?Object.assign(a,n):n.weapon===r.weapon?(a.tie=!0,a.weapon=n.weapon):Object.assign(a,r),a},y=function(e){return e.collection("players").get().then((function(e){e.docs.forEach((function(e){return e.ref.update({weapon:null})}))}))},N=function(e){return f.collectionGroup("players").where("userId","==",e).get().then((function(e){return e.docs.map((function(e){return e.ref.parent.parent}))}))},w=function(){var e={};try{e=JSON.parse(localStorage.getItem("player"))||{}}catch(a){console.log("Deleting corrupted player in local storage."),localStorage.removeItem("player")}return e},O=function(e){return localStorage.setItem("player",JSON.stringify(e))},j=function(){var e=Object(p.a)(u.a.mark((function e(a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",f.collection("users").add(a).then((function(e){return a.id=e.id,a})));case 1:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),k=function(){var e=Object(p.a)(u.a.mark((function e(a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",f.collection("users").doc(a).get().then((function(e){return e.data()})));case 1:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}();var I=function(){var e=w().id,a=Object(n.useState)({}),t=Object(i.a)(a,2),c=t[0],s=t[1],l=Object(n.useState)({}),m=Object(i.a)(l,2),u=m[0],p=m[1],d=Object(n.useState)({}),f=Object(i.a)(d,2),b=f[0],h=f[1],v=Object(n.useState)({wins:0,ties:0,losses:0}),E=Object(i.a)(v,2),y=E[0],O=E[1];Object(n.useEffect)((function(){N(e).then((function(e){var a=e.map((function(e){return e.collection("players").get()}));Promise.all(a).then(j)}))}),[e]);var j=function(a){var t=Object.assign({},c),n=Object.assign({},u),r=Object.assign({},b),o=Object.assign({},y);a.forEach((function(a){var c=a.docs[0].ref.parent.parent;if(a.size<2)t[c.id]=c;else{t.hasOwnProperty(c.id)&&delete t[c.id];var s=a.docs.map((function(e){return e.data()})),l=g(s);if(null===l.userId&&!1===l.tie)s.find((function(a){return a.userId===e})).weapon?n[c.id]=c:r[c.id]=c;else n.hasOwnProperty(c.id)?delete n[c.id]:r.hasOwnProperty(c.id)&&delete r[c.id],l.userId===e?o.wins++:l.tie?o.ties++:null!==l.userId&&o.losses++}})),s(t),p(n),h(r),O(o)};return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-8 offset-sm-2"},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},"Dashboard"),r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"card-title"},"Your Stats"),r.a.createElement("p",{className:"card-text"},r.a.createElement("span",{className:"strong"},"Wins:")," ",y.wins),r.a.createElement("p",{className:"card-text"},r.a.createElement("span",{className:"strong"},"Ties:")," ",y.ties),r.a.createElement("p",{className:"card-text"},r.a.createElement("span",{className:"strong"},"Losses:")," ",y.losses),r.a.createElement("hr",null),r.a.createElement("h5",{className:"card-title"},"Waiting for an opponent..."),r.a.createElement("div",{className:"btn-group-vertical d-block"},Object.keys(c).map((function(e){return r.a.createElement(o.b,{className:"btn btn-primary",to:"/game/".concat(e),key:e},e)}))),r.a.createElement("hr",null),r.a.createElement("h5",{className:"card-title"},"Waiting for opponent's move..."),r.a.createElement("div",{className:"btn-group-vertical d-block"},Object.keys(u).map((function(e){return r.a.createElement(o.b,{className:"btn btn-primary",to:"/game/".concat(e),key:e},e)}))),r.a.createElement("hr",null),r.a.createElement("h5",{className:"card-title"},"Waiting for your move..."),r.a.createElement("div",{className:"btn-group-vertical d-block"},Object.keys(b).map((function(e){return r.a.createElement(o.b,{className:"btn btn-primary",to:"/game/".concat(e),key:e},e)})))))))},S=function(e,a){if(!(e instanceof Object&&a instanceof Object))return!1;var t=Object.keys(e);if(t.length!==Object.keys(a).length)return!1;for(var n=0;n<t.length;n++){var r=t[n];if(e[r]!==a[r])return!1}return!0},x=function e(a,t){if(!(a instanceof Array&&t instanceof Array)||a.length!==t.length)return!1;for(var n=a.slice(0).sort(),r=t.slice(0).sort(),c=0;c<n.length;c++){var s=n[c],o=r[c];if(!(s instanceof Object&&S(s,o)||s instanceof Array&&e(s,o)||s===o))return!1}return!0};var D=function(e){var a=e.gameDocument,t=e.players,c=e.userId,s=Object(n.useState)(null),l=Object(i.a)(s,2),m=l[0],u=l[1],p=Object(n.useState)({}),d=Object(i.a)(p,2),f=d[0],b=d[1];Object(n.useEffect)((function(){E(a,c).then((function(e){return u(e)}))}),[a,c]),Object(n.useEffect)((function(){var e=g(t);S(e,f)||b(e)}),[t]);var h=function(){return t.map((function(e){return e.name})).join(" vs. ")},N=function(e){var a="";switch(e){case"Rock":a="fas fa-hand-rock";break;case"Paper":a="fas fa-hand-paper";break;case"Scissors":a="fas fa-hand-scissors";break;default:return null}return r.a.createElement("i",{className:a})},w=function(e){var t=e.currentTarget.dataset.name;v(a,c,t).then((function(){return u(t)}))};return f.tie?(setTimeout((function(){y(a),u(null),b({})}),3e3),r.a.createElement(r.a.Fragment,null,r.a.createElement("h5",{className:"card-title"},h()),r.a.createElement("p",{className:"card-text"},"It was a tie! Both selected ",r.a.createElement("span",{className:"text-primary"},N(f.weapon)),". Starting a new match..."))):f.userId?r.a.createElement(r.a.Fragment,null,r.a.createElement("h5",{className:"card-title"},f.userId===c?["Congrats, you beat ".concat(t.find((function(e){return e.userId!==f.userId})).name," with "),r.a.createElement("span",{className:"text-primary",key:m},N(m)),"!"]:["Sorry, ".concat(f.name," won with "),r.a.createElement("span",{className:"text-primary",key:m},N(f.weapon)),"."]),r.a.createElement(o.b,{to:"/home",className:"btn btn-primary btn-block"},"Play again?")):r.a.createElement(r.a.Fragment,null,r.a.createElement("h5",{className:"card-title"},h()),m?r.a.createElement("p",{className:"card-text"},"You chose ",r.a.createElement("span",{className:"text-primary"},N(m)),"!",r.a.createElement("br",null),"Waiting for your opponent..."):r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{className:"card-text"},"Choose your weapon!"),r.a.createElement("div",{className:"btn-group d-flex"},["Rock","Paper","Scissors"].map((function(e){return r.a.createElement("button",{type:"button",className:"btn btn-outline-primary",style:{flexGrow:1},"data-name":e,onClick:w,key:e},N(e))})))))};var P=function(){var e=Object(l.g)().gameId,a=w().id,t=b(e),c=Object(n.useState)([]),s=Object(i.a)(c,2),o=s[0],m=s[1],u=Object(n.useState)(null),p=Object(i.a)(u,2),d=p[0],f=p[1];return Object(n.useEffect)((function(){return t.collection("players").onSnapshot((function(e){var n=e.docs.map((function(e){var a=e.data(),t=a.userId,n=a.weapon;return k(t).then((function(e){return e.userId=t,e.weapon=n,e}))}));Promise.all(n).then((function(e){if(!e.find((function(e){return e.userId===a})))return e.length<2&&a?h(t,a):f("/home");x(e,o)||m(e)}))}))}),[]),d?r.a.createElement(l.a,{to:d}):r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-8 offset-sm-2"},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},e),r.a.createElement("div",{className:"card-body"},o.length<2?r.a.createElement("h5",{className:"card-title"},"Waiting for player..."):r.a.createElement(D,{gameDocument:t,players:o,userId:a})))))};var R=function(e){var a=e.user,t=e.setUser;return"undefined"!==typeof a.name&&"undefined"!==typeof a.email?null:r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"card-title"},"New phone, who dis?"),r.a.createElement("p",{className:"card-text"},"Before we begin, I need to know who you are"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var a=e.target.elements.name.value.trim(),n=e.target.elements.email.value.trim().toLowerCase();a&&n&&j({name:a,email:n}).then(t)}},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"text",className:"form-control",name:"name",placeholder:"Your Name"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"email",className:"form-control",name:"email",placeholder:"Your Email"})),r.a.createElement("button",{type:"submit",className:"btn btn-primary btn-block"},"Let's RPS!"))))};var W=function(e){e.userId;var a=Object(n.useState)(null),t=Object(i.a)(a,2),c=t[0],s=t[1];return c?r.a.createElement(l.a,{to:"/game/".concat(c)}):r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-body"},r.a.createElement("p",{className:"card-text"},"Decide if you want to start a new game, or join an existing one"),r.a.createElement("button",{className:"btn btn-primary btn-block mb-3",onClick:function(){var e="Game_".concat(Math.round(1e3*Math.random()));s(e)}},"Start a new game"),r.a.createElement("hr",null),r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var a=e.target.elements.name.value.trim();s(a)}},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"text",className:"form-control",name:"name",placeholder:"Game Name"})),r.a.createElement("button",{type:"submit",className:"btn btn-primary btn-block"},"Join a game"))))};var C=function(){var e=Object(n.useState)(w()),a=Object(i.a)(e,2),t=a[0],c=a[1];return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-8 offset-sm-2"},r.a.createElement(R,{user:t,setUser:function(e){O(e),c(e)}}),t.id?r.a.createElement(W,{userId:t.id}):null))};var A=function(){var e=Object(l.h)({path:"/dashboard",strict:!0}),a=Object(l.h)({path:"/home",strict:!0});return r.a.createElement("nav",{className:"navbar navbar-expand navbar-light bg-light mb-5"},r.a.createElement("div",{className:"collapse navbar-collapse"},r.a.createElement("ul",{className:"navbar-nav"},r.a.createElement("li",{className:"nav-item".concat(a?" active":"")},r.a.createElement(o.b,{className:"nav-link",to:"/home"},"Home")),r.a.createElement("li",{className:"nav-item".concat(e?" active":"")},r.a.createElement(o.b,{className:"nav-link",to:"/dashboard"},"Dashboard")))))};var B=function(){return r.a.createElement(o.a,null,r.a.createElement(A,null),r.a.createElement(l.d,null,r.a.createElement(l.a,{exact:!0,from:"/",to:"/home"}),r.a.createElement(l.b,{path:"/game/:gameId"},r.a.createElement(P,null)),r.a.createElement(l.b,{path:"/dashboard"},r.a.createElement(I,null)),r.a.createElement(l.b,{path:"/home"},r.a.createElement(C,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(B,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[26,1,2]]]);
//# sourceMappingURL=main.640af84f.chunk.js.map